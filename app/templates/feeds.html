{% extends "base.html" %}

{% block title %}Security Feeds - dotne1's Cybersecurity Portfolio{% endblock %}

{% block content %}
<h1 class="main-header">Security Feeds</h1>
<div class="glitch" data-text="dotne1 // hacker // codebreaker // reverse engineer">dotne1 // hacker // codebreaker // reverse engineer</div>
<div class="section">
    <h2>Latest Vulnerabilities</h2>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search CVEs..." onkeyup="searchCVEs()">
    </div>
    <div class="feed-preview" id="cveFeed">
        <div class="feed-header">Latest Vulnerabilities</div>
        {% for cve in cves %}
        <div class="cve-entry" data-cve-id="{{ cve.cve_id }}" data-description="{{ cve.description }}">
            <h2><a class="contact-button" href="{{ cve.source_url }}" target="_blank">{{ cve.cve_id }}</a></h2>
            <p><span class="feed-label">Published:</span> {{ cve.published_date }}</p>
            <p><span class="feed-label">Severity:</span> <span class="status-{{ cve.severity.lower() }}">{{ cve.severity }}</span></p>
            <p><span class="feed-label">CVSS Score:</span> {{ cve.cvss_score }}</p>
            <p>{{ cve.description }}</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function searchCVEs() {
    const input = document.getElementById('searchInput').value.toLowerCase();
    const cveEntries = document.getElementsByClassName('cve-entry');
    for (let i = 0; i < cveEntries.length; i++) {
        const cveId = cveEntries[i].getAttribute('data-cve-id').toLowerCase();
        const description = cveEntries[i].getAttribute('data-description').toLowerCase();
        if (cveId.includes(input) || description.includes(input)) {
            cveEntries[i].style.display = '';
        } else {
            cveEntries[i].style.display = 'none';
        }
    }
}
</script>
{% endblock %}
    